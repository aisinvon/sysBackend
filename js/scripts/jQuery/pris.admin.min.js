var prisAdmGCfg={stamp:(new Date()).getTime()};Date.prototype.addDays=function(a){var b=this.valueOf();b+=86400000*a;return new Date(b);};Date.prototype.convertDate=function(c){var b=true;var d=c.split("-");if(d.length!=3){d=c.split("/");if(d.length!=3){return null;}b=false;}var a=new Date();if(b){a.setFullYear(d[0],d[1]-1,d[2]);}else{a.setFullYear(d[2],d[1]-1,d[0]);}a.setHours(0,0,0);return a;};Date.prototype.format=function(b){var a=this;var c=function(g,f){if(!f){f=2;}g=new String(g);for(var e=0,d="";e<(f-g.length);e++){d+="0";}return d+g;};return b.replace(/"[^"]*"|'[^']*'|\b(?:d{1,4}|M{1,4}|yy(?:yy)?|([hHmstT])\1?|[lLZ])\b/g,function(d){switch(d){case"d":return a.getDate();case"dd":return c(a.getDate());case"ddd":return["Sun","Mon","Tue","Wed","Thr","Fri","Sat"][a.getDay()];case"dddd":return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][a.getDay()];case"M":return a.getMonth()+1;case"MM":return c(a.getMonth()+1);case"MMM":return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][a.getMonth()];case"MMMM":return["January","February","March","April","May","June","July","August","September","October","November","December"][a.getMonth()];case"yy":return new String(a.getFullYear()).substr(2);case"yyyy":return a.getFullYear();case"h":return a.getHours()%12||12;case"hh":return c(a.getHours()%12||12);case"H":return a.getHours();case"HH":return c(a.getHours());case"m":return a.getMinutes();case"mm":return c(a.getMinutes());case"s":return a.getSeconds();case"ss":return c(a.getSeconds());case"l":return a.getMilliseconds();case"ll":return c(a.getMilliseconds());case"tt":return a.getHours()<12?"am":"pm";case"TT":return a.getHours()<12?"AM":"PM";}});};Array.prototype.remove=function(b){for(var a=0;a<this.length;a++){if(this[a]==b){this.splice(a,1);break;}}};var fedPris={tdEvenOdd:function(){var b=("tbody tr"),a=$(b),d=a.find("td"),c;d.each(function(){var g=$(this),e=g.parent(),f=g.attr("rowspan");if(f!=undefined&&f!==""&&f!=="1"){g.addClass("rowspan").parent().addClass("parent");}});$(document).on("mouseenter",b,function(){var f=$(this),e=f.prevAll(".parent").length-1;f.addClass("on");if(f.hasClass("parent")){f.removeClass("parentOn");}else{f.siblings(".parent").eq(e).addClass("parentOn");}});$(document).on("mouseleave",b,function(){$(this).removeClass("on").siblings().removeClass("parentOn");});},navHover:function(){var a=$(".nav>.wrap>ul>li").index($(".on")),b;$(".nav li").hover(function(){var c=$(this);c.addClass("on").siblings().not(".on").removeClass("on");b=setTimeout(function(){c.children("ul").show();},100);},function(){var c=$(this);clearTimeout(b);c.removeClass("on");c.children("ul").hide();});$(".nav>.wrap>ul>li").mouseleave(function(){$(".nav>.wrap>ul>li").eq(a).addClass("on");});},selectAll:function(){var a=$("#billing_table input:isChecked").length;if(a===0){$("#billing_table").siblings().find(".black_btn:contains(Submit)").prop("disabled","disabled").addClass("btn_disabled");}$(".main").on("click","input:checkbox",function(){var g=$(this),c,f=g.closest("table"),b=f.find("tbody input:checkbox").not(":disabled"),e=f.find(".select_all input"),d=b.length;if(g.prop("isChecked")){g.parent().hasClass("select_all")?b.prop("isChecked",true):g.prop("isChecked",true);}else{g.parent().hasClass("select_all")?b.prop("isChecked",false):g.prop("isChecked",false);}c=f.find("input:isChecked").not(".select_all input").length;f.prev().find(".num_toBeSbmt").text(c);f.next().find(".num_toBeSbmt").text(c);if(c===0){f.siblings().find(".black_btn:contains(Submit)").prop("disabled","disabled").addClass("btn_disabled").removeClass("prim");}else{f.siblings().find(".black_btn:contains(Submit)").removeAttr("disabled").removeClass("btn_disabled").addClass("prim");}if(c===d&&d!==0){e.prop("isChecked","isChecked");}else{e.removeAttr("isChecked");}});},toTop:function(){$(".to_top").click(function(){$("html, body").stop().animate({scrollTop:0},400);return false;});function a(){var c=$(".pageWrapper .fixed"),d=$(document).height(),e=$(window).scrollTop(),b=$(window).height();if((d-e-b)<65){c.css({bottom:115-(d-e-b)});}else{c.css({bottom:""});}}$(window).scroll(function(){a();});a();},feedback:function(){$("#to_feedback").click(function(){var c=$(this),a=$(".pop_feedback",this).html(),b="<div id='pop_feedback' class='pop_win_in'><div class='pop_feedback'>"+a+"</div></div>";fedPris.popWinShow({id:"#pop_feedback",maskOut:true,maskIn:false,newPop:b});return false;});},fixedTable:function(){$(".add_row").click(function(a){$(".reject_text").hide();if($(this).hasClass("on")){$(this).removeClass("on");$(".fixed_table").hide();}else{$(this).addClass("on");$(".fixed_table").show();}a.stopPropagation();});$("body").click(function(){$(".fixed_table").hide();$(".add_row, #customize").removeClass("on");});$(".fixed_table").click(function(a){a.stopPropagation();});},showTip:function(){$(".main").on("mouseenter",".jsTipIco",function(){var a=$(this);a.next(".jsTip").show();a.closest("td").css("zIndex","2");});$(".main").on("mouseleave",".jsTipIco",function(){var a=$(this);a.next(".jsTip").hide();a.closest("td").removeAttr("style");});},rejTextarea:function(){$("table").on("click",".reject",function(a){$(this).next(".reject_text").show();$(this).closest("td").addClass("cur");$(this).closest("tr").siblings().find(".reject_text").hide();$(this).closest("tr").siblings().find(".cur").removeClass("cur");$(".add_row").removeClass("on");$(".fixed_table").hide();a.stopPropagation();});$("body").click(function(){$(".reject_text").hide();});$("table").on("click",".reject_text",function(a){a.stopPropagation();});$("table").on("click",".cancel",function(){$(this).parent().hide();$(".add_row").removeClass("on");$(".fixed_table").hide();});},sortTable:function(d){var a=d+"thead th";$(document).on("click",a,function(){var f=$(this).attr("data-type");if(f==undefined||f==""){return;}var i=$(this).closest("table"),h=i.find("thead th").index(this)+1,e=[],j=i.find("tbody tr").not(".editable, .jsTip tr");$.each(j,function(k){e[k]=j[k];});if($(this).hasClass("ascend")){e.reverse();$(this).removeClass("ascend descend").addClass("descend").siblings().removeClass("ascend descend");}else{e.sort(c(h,f));$(this).removeClass("ascend descend").addClass("ascend").siblings().removeClass("ascend descend");}var g=document.createDocumentFragment();$.each(e,function(k){g.appendChild(e[k]);});i.find("tbody").not(".jsTip tbody").prepend(g);fedPris.tdEvenOdd();});function c(f,e){return function(i,h){var g=$(i).find("td:nth-child("+f+")").text().replace(/\s*/,""),j=$(h).find("td:nth-child("+f+")").text().replace(/\s*/,"");if(e!="text"){g=b(g,e);j=b(j,e);if(g<j){return -1;}else{if(g>j){return 1;}else{return 0;}}}else{return g.localeCompare(j);}};}function b(f,e){switch(e){case"int":return parseInt(f);case"float":return parseFloat(f);default:return f.toString();}}return{howSort:c};},prisTab:function(c,b){var a=b,g=$(c+">.tab_tit"),f=$(c+">.tab_con"),d=$(c+">.tab_tit>li"),e=$(c+">.tab_tit>.on"),a=d.index(e);if(a==undefined||a==""||a=="-1"){$("li",g).eq(0).addClass("on").siblings().removeClass("on");f.eq(0).show().siblings(".tab_con").hide();}else{$("li",g).eq(a).addClass("on").siblings().removeClass("on");f.eq(a).show().siblings(".tab_con").hide();}$(".main").on("click","li",function(){a=$(this).parent().children("li").index($(this));$(this).addClass("on").siblings().removeClass("on");$(this).parent().siblings(".tab_con").eq(a).show().siblings(".tab_con").hide();});return a;},inputTips:function(a){var h=(".text, textarea"),g=$("input:disabled, textarea:disabled, textarea[readonly=readonly], select:disabled"),e;if(a==undefined||a==""){e=$("input[tip], textarea[tip]");}else{e=$("input[tip], textarea[tip]",a);}for(var d=0;d<e.length;d++){var k=e.eq(d),c=k.attr("tip"),f=k.attr("value");if(f==undefined||f==""||f==c){k.val(c);k.addClass("default");}else{k.addClass("normal");}}for(var b=0;b<g.length;b++){g.eq(b).addClass("disabled");}$(document).on("click",h,function(){var j=$(this),i=j.attr("tip");j.addClass("on");if(j.val()==i){j.val("");j.addClass("normal");}});$(document).on("blur",h,function(){var j=$(this),i=j.attr("tip");j.removeClass("on");if((j.val()).replace(/\s*/g,"")==""){j.val(i);j.removeClass("normal");}});},clearIptDefaultVal:function(){var a=$("input[tip], textarea[tip]");a.each(function(){var b=$(this);if(b.val()==b.attr("tip")){b.val("");}});},modShowHide:function(d){var f=$(".mod_toggle");f.each(function(){var k=$(".mod_input",this),j=k.length,h;for(h=0;h<j;h++){k.eq(h).attr("data-mod-idx",h);k.eq(h).find(".tit_index").text(h+1);k.eq(0).addClass("mod_input_first");}});var e,g,c,b=0;if(d!=undefined||d!=""){f.eq(d).addClass("on");f.eq(d).find(".toggle_con").show();}$(document).delegate(".mod_toggle>h4","click",function(){var h=$(this).closest(".mod_toggle");c=$(this).closest(".mod_toggle").attr("id");e=$(this).parent().siblings(".toggle_con").find(".mod_input:eq(0)");if(h.hasClass("on")){h.removeClass("on");}else{h.addClass("on");}});function a(j,h,i){$(j,h).each(function(){var k=$(this).attr(i),l,m=$(this).attr("data-copy");if(/\d+/g.test(k)===true){l=k.replace(/\d+/g,b);}else{l=k+"_"+b;}if($(".tit_index",h)){$(h).find(".tit_index").text(b+1);}if($(j).hasClass("field-validation-error")){$(".field-validation-error span",h).remove();$(".field-validation-error",h).attr("class","field-validation-valid");}$(".input-validation-error",h).removeClass("input-validation-error");$(".hasDatepicker",h).removeClass("hasDatepicker");if(k!=undefined&&k!=""){$(this).attr(i,l);}if(m===undefined||m===""){$(this).val("").removeClass("normal");}});}$(".toggle_con").delegate(".delInfoIco","click",function(){var i=$(this).closest(".toggle_con").find(".mod_input").index($(this).parent()),h=$(this).closest(".toggle_con").find(".mod_input").length-1;if(i!=0&&i==h){$(this).parent().remove();}});$("#Summary").focus(function(){$(this).parent().addClass("on");}).blur(function(){$(this).parent().removeClass("on");});},showCustomize:function(){$("#customize").click(function(a){$(this).addClass("on");$(".fixed_table").show();a.stopPropagation();});},datePicker:function(){var a=new Date().getFullYear(),b={selectedYear:a,startYear:a-2,finalYear:a+2};try{$("#from, #to, .only_month").monthpicker(b).bind("monthpicker-hide",function(){var e=$(this),d=e.val();if(d!=""){e.addClass("normal");}});}catch(c){}$("body").on("focus",".date_month",function(){if($(this).attr("id")==="Birthdate"){$(this).datepicker({changeMonth:true,changeYear:true,minDate:"-80y",maxDate:"-10y",defaultDate:"-30y",onClose:function(){var e=$(this),d=e.val();if(d!=""){e.addClass("normal");}setTimeout(function(){e.trigger("blur");},100);}});}else{$(this).datepicker({changeMonth:true,changeYear:true,minDate:"-10y",maxDate:"0",onClose:function(){var e=$(this),d=e.val();if(d!=""){e.addClass("normal");}setTimeout(function(){e.trigger("blur");},100);}});}});$("body").on("focus",".date_month_meeting",function(){$(this).datepicker({changeMonth:true,changeYear:true,minDate:"-10y",maxDate:"+1y",onClose:function(){var e=$(this),d=e.val();if(d!=""){e.addClass("normal");}setTimeout(function(){e.trigger("blur");},100);}});});$(".ui-datepicker").click(function(d){d.stopPropagation();});},rangeSelect:function(){var a=new Date().getMonth();$(".tab_chart .auto_btn_h16").click(function(){$(this).addClass("on").siblings(".auto_btn_h16").removeClass("on");});$("#6_month").click(function(){var c=$("#report_con_1").highcharts(),b=a-5;if(b<1){c.xAxis[0].setExtremes(0,5);}else{c.xAxis[0].setExtremes(b,a);}});$("#ytd").click(function(){var b=$("#report_con_1").highcharts();b.xAxis[0].setExtremes(0,a);});$("#1_year").click(function(){var b=$("#report_con_1").highcharts();b.xAxis[0].setExtremes(0,11);});},staffTableClass:function(a){$(a).delegate("thead th","click",function(){$("tbody tr",a).removeClass("first_tr");fedPris.staffTableClass(a);});},editSlctProj:function(){$(".act_edit").click(function(){var a=$(this).parent().siblings(".staff_table");$(this).hide().siblings(".act_more").show();a.find(".proj_slct").show();a.find(".proj_slct").siblings(".proj_slcted").hide();return false;});$(".act_cancel").click(function(){var a=$(this).parent().parent().siblings(".staff_table");$(this).parent().hide();$(this).parent().siblings(".act_edit").show();a.find(".proj_slcted").show();a.find(".proj_slcted").siblings(".proj_slct").hide();});},titleTips:function(b){var d,c,g,h,a,j,f,i,e;if(b===undefined){d=$(".tit_tip, input, div, button, i, span");}else{d=$(b);}$(d).mouseenter(function(){var k=$(this);e=k.attr("data-title");g=k.attr("title");if(e==="no_tit_tip"||g===undefined){return;}if(e==undefined||e==""){g=this.title;k.attr("data-title",g);}else{g=e;}this.title="";f=k.outerHeight();i=k.outerWidth();if(g!=undefined&&g!=""){a=k.offset().left;j=k.offset().top+f+8;if($("#tool_tip").length===0){h='<div id="tool_tip" class="tool_tip" style="left:'+a+"px; top:"+j+'px;"><i></i><div class="tool_txt">'+g+"</div></div>";$(".pageWrapper").append(h);}else{$("#tool_tip").css({left:a,top:j});$("#tool_tip .tool_txt").html(g);}if(b!==undefined){c=b.replace(/[.#]/,"")+"_tool_tip";$("#tool_tip").addClass(c);}$("#tool_tip").show();}}).mouseleave(function(){$("#tool_tip").hide();$("#tool_tip").attr("class","tool_tip");});},popWinShow:function(e){var j=$("#pop_win"),f=$(".pop_win_in"),l=$("#pop_win_mask"),k=$("#pop_win .pop_win_in_mask"),h={maskOut:true,maskIn:false,autoClose:false,outAreaClose:true,fixed:true},d,b,g,i;var a={};a=$.extend(h,e);j.attr("style","");$(a.id).show().siblings().hide();a.maskOut===true?l.show():l.hide();a.maskIn===true?k.show():k.hide();if(a.newPop!==undefined){if($(a.id).length===0){j.append(a.newPop);}$(a.id).show().siblings().hide();}if(a.autoClose!==false){setTimeout(function(){d();},a.autoClose);}if(a.outAreaClose===true){l.click(function(){d();});}if(a.fixed){j.removeClass("pop_win_absolute");}else{j.addClass("pop_win_absolute");var c=$(window).scrollTop()+50;if(c>150){j.css("top",c);}}b=$(a.id).outerWidth();g=-($(a.id).outerHeight()/2)+"px";i=-(b/2)+"px";j.css({width:b,marginTop:g,marginLeft:i});j.on("click",".pop_win_close",function(){d();});d=function(){a.newPop===undefined?$(a.id).hide():$(a.id).remove();f.hide();l.hide();k.hide();};},closeAllPop:function(d){var b=$("#pop_win .pop_win_in"),a=$("#pop_win_mask"),c=$("#pop_win .pop_win_in_mask");if(d===undefined){b.hide();a.hide();c.hide();}else{setTimeout(function(){b.hide();a.hide();c.hide();},d);}},confirmDialog:function(c){var b={id:"#pop_win_unlock",message:"",clickId:null,excuFun:null};var a={};a=$.extend(b,c);if(a.message!==""){$(".js_message",a.id).text(a.message);}if(a.excuFun!==null&&a.clickId!==null){$(a.clickId).unbind().bind("click",function(){(a.excuFun&&typeof(a.excuFun)==="function")&&a.excuFun();});}fedPris.popWinShow({id:a.id,maskIn:true,maskOut:true});},dialog:function(d){var e={id:"#pop_win_dialog",message:"",type:"confirm",btnOkTxt:"Ok",btnCancelTxt:"Cancel",clickId:null,excuFun:null},i,b,c,f,h,g;var a={};a=$.extend(e,d);i=a.id.replace(/[.|#]/g,"");c="<div id='"+i+"' class='pop_win_in pop_win_dialog'>";f="</div>";a.message===""?h="":h="<p class='tc js_message'>"+a.message+"</p>";if(a.type==="confirm"){g="<p class='tc mt'><button class='auto_c_btn cancel pop_win_close' type='button'>"+a.btnCancelTxt+"</button><button class='auto_c_btn prim sbmt' type='button'>"+a.btnOkTxt+"</button></p>";}else{g="<p class='tc mt'><button class='auto_c_btn prism pop_win_close' type='button'>"+a.btnOkTxt+"</button></p>";}b=c+h+g+f;$("#pop_win").append(b);if(a.excuFun!==null&&a.clickId!==null){$(a.clickId).unbind().bind("click",function(){(a.excuFun&&typeof(a.excuFun)==="function")&&a.excuFun();});}fedPris.popWinShow({id:"#"+i,maskIn:true,maskOut:true});$("#pop_win").on("click",".pop_win_close",function(){$(a.id).remove();});},addHeadc:function(){$("body").on("click",".action_p",function(a){var b=$(this);b.siblings(".pop_headc").show();b.closest("tr").siblings().find(".pop_headc").hide();a.stopPropagation();});$("body").on("click",".pop_headc .close",function(){$(this).closest(".pop_headc").hide();});$("body").click(function(){$(".pop_headc").hide();});$("body").on("click",".pop_headc",function(a){a.stopPropagation();});},print:function(){$(".black_btn:contains('Print'), .print_btn").click(function(){window.print();});},disableIpt:function(e,a,b){var d=$(".text, select",e).not(b),c=$("textarea",e).not(b);if(a==="open"){d.removeProp("disabled").removeClass("disabled");c.removeProp("readonly").removeClass("disabled");}else{d.prop("disabled","disabled").addClass("disabled");c.prop("readonly","readonly").addClass("disabled");}},selectMulti:function(d){var b=d.replace(/[.#]/,""),a=d+" .js_parent";try{document.getElementById(b).onselectstart=function(){return false;};}catch(c){}$(d).on("click",".js_parent",function(m){var k=$(this),q=$(a),l=k.parent().find(".selected"),n=l.length,h=q.index(k);if(k.hasClass("selected")){if(m.ctrlKey||m.shiftKey){k.removeClass("selected");}else{n===0?k.removeClass("selected"):k.siblings().removeClass("selected");}}else{m.ctrlKey?k.addClass("selected"):k.addClass("selected").siblings().removeClass("selected");if(m.shiftKey){q.removeClass("selected");if(n===0){q.removeClass("selected");for(var f=0;f<(h+1);f++){q.eq(f).addClass("selected");}}else{var p=[],o,g,j;l.each(function(){o=q.index($(this));p.push(o);});g=Math.min.apply(Math,p);j=Math.max.apply(Math,p);if(h>j){for(var f=g;f<(h+1);f++){q.eq(f).addClass("selected");}}else{if(h<g){for(var f=h;f<(j+1);f++){q.eq(f).addClass("selected");}}}}}}});$(d).on("dblclick",".js_parent",function(){var f=$(this),e=f.parent();if(e.hasClass("js_tls_result")){$(".to_l",d).triggerHandler("click");}else{$(".to_r",d).triggerHandler("click");}});$(".tls_btn span",d).click(function(){var f=$(this);if(f.hasClass("to_r")){fedPris.moveSlctToR(d);}else{var e;$(".js_tls_result .selected",d).each(function(){var g=$(this);e=g.attr("eid");$(".tls_table .js_parent[eid='"+e+"']",d).show().removeClass("selected js_none");g.remove();});}});},moveSlctToR:function(g){var e="",b,d,c,f,a;c=$(".tls_table .selected",g);a=$(".tls_result",g);c.each(function(){b=$("td:first",this).text(),d=$("td:last",this).text(),f=d.replace(/\'/,"-");e+="<p class='js_parent' ename='"+f+"' eid="+b+"><span class='js_child'>"+b+"</span>/<span class='js_child'>"+d+"</span></p>";});c.addClass("js_none").removeClass("selected").hide();$(e).appendTo(a);},selectTL:function(b){var i,j=$(".tls_slct_btn"),e,g=b+" .js_tls_ipt .text";$(".tls_selected_list").each(function(){var m=$(this),l=$("p",m),k=l.length;if(k>0){m.show();}});var d=$(this),a=d.parent().siblings(".label").text().replace(/\*|\:/g,"")+" selector",h=$(g).removeClass("normal").attr("tip"),e=$(b).attr("data-source-idName"),f=$(".js_parent",b).length;if(f===0){$(".js_table .in",b).append("<p id='tls_tip' class='mt tc'>Loading, please wait...</p>");$.getJSON(e,function(k){var l=k;c(l);fedPris.listFilter(g,(b+" .js_table .js_parent"));}).done(function(){$("#tls_tip").hide();});}$(g).val(h);i=$(".tls_slct_btn").index(d);$(b).attr("data-idx",i);$(".js_tls_result",b).html("");$(".js_table tbody tr",b).show().removeClass("selected js_none");fedPris.selectMulti(b);d.siblings(".tls_selected_list").find(".js_parent").each(function(){var k=$(this).attr("eid");$(".tls_table .js_parent[eid='"+k+"']",b).addClass("selected");});fedPris.moveSlctToR(b);function c(n){var q=n,k=q.length,o,s,r="",p="";for(o=0;o<k;o++){if(q[o].selected==="true"){s="<tr class='js_parent none' eid="+q[o].id+"><td>"+q[o].id+"</td><td>"+q[o].name+"</td></tr>";var l=q[o].id.replace(/^[A-Za-z]/gi,""),m=q[o].name.replace(/\-/,"'");r+="<p class='js_parent' ename='"+m+"' eid="+l+"><span class='js_child'>"+q[o].id+"</span>/<span class='js_child'>"+q[o].name+"</span></p>";$(".js_tls_result",b).html("").append(r);}else{s="<tr class='js_parent' eid="+q[o].id+"><td>"+q[o].id+"</td><td>"+q[o].name+"</td></tr>";}p+=s;}$(".js_table tbody",b).html("").append(p);}$(".sbmt",b).click(function(){var q=[],o={},k,n,l,r,p="",m=$(".tls_selected_list").eq(i);$(".js_tls_result p",b).each(function(){var s=$(this);o.id=s.attr("eid"),n=o.id.replace(/^[A-Za-z]/gi,""),o.name=s.attr("ename");r=o.name.replace(/\-/,"'");p+="<p class='js_parent' ename='"+o.name+"' eid="+o.id+"><a href='/Profile/Edit?userId="+n+"'><span class='js_child'>"+o.id+"</span><span>/</span><span class='js_child'>"+r+"</span></a><i class='delIco'></i></p>";q.push(o);});if(q.length===0){return;}m.html("").append(p).show();fedPris.storeSlctVal(m,i);});$(".tls_selected_list").on("click",".delIco",function(){if($(".proj_status:isChecked").val()==="Close"||$("input#close").length===0){return;}var o=$(this),n=$(".tls_slct_btn").index(o.closest(".tls_selected_list").siblings(".tls_slct_btn")),l=o.parent().attr("eid"),k=$(".tls_selected_list p").length-1,m=$(".tls_selected_list").eq(n);if(k===0){$(".tls_selected_list").hide();}o.parent().remove();fedPris.showDeleted(l,b);fedPris.storeSlctVal(m,n);});},listFilter:function(b,c){var a=$(c);$(b).keyup(function(){var f=$(this),e=f.val(),d=e.length;if(d>1){a.each(function(){var h=$(this),g=h.text();setTimeout(function(){h.hasClass("js_none")||g.search(new RegExp(e,"i"))<0?h.hide():h.show();},500);});}else{a.not(".js_none").show();}});},showDeleted:function(b,d){var a=b,c=d;$(".js_table tbody tr",c).each(function(){var f=$(this),e=f.attr("eid");if(e===a){f.show();}});$(".js_tls_result .js_parent",c).each(function(){var f=$(this),e=f.attr("eid");if(e===a){f.remove();}});},storeSlctVal:function(h,a){var b=h,d=a,c,g,e="",f="";$("p",b).each(function(){var i=$(this);selectedId=i.attr("eid");c=i.attr("ename");g=c.replace(/\-/,"'");f+=selectedId+"/";e+=g+"/";});$(".tls_slctId").eq(d).val(f);$(".tls_slctName").eq(d).val(e);},TriggerSameSlct:function(){$("select").change(function(){var c=$(this);if(c.attr("data-group")===undefined){return;}var a=c.attr("data-group"),b=$("option:selected",c).text();$("select").each(function(){var e=$(this),d=e.attr("data-group");if(a===d){$("option",e).each(function(){var f=$(this),g=f.text();if(b===g){f.prop("selected","selected");}});}});});},blurHiddenIpt:function(a){$(a).click(function(){$(this).blur();});},zTree:function(n){var t={},b=$.extend(t,n),a=b.id.replace(/[.#]/,""),d=1,e="dark",f=null,w=null,c,x=$("#api_prefix").val(),v=Number(window.location.hash.replace(/\B#.*\B:/,"")),m={view:{addHoverDom:u,removeHoverDom:g,showIcon:false},edit:{enable:true,showRenameBtn:false,drag:{isCopy:false,isMove:false}},data:{simpleData:{enable:true}},callback:{onClick:i,beforeRemove:s,onRemove:r}},l={view:{showIcon:false},check:{enable:true},data:{simpleData:{enable:true}},callback:{onClick:i,beforeRemove:s}},k={view:{showIcon:false},edit:{enable:false},data:{simpleData:{enable:true}},callback:{onClick:i,beforeRemove:s}},q={};if(b.setting==="1"){q=m;}else{if(b.setting==="2"){q=l;}else{q=k;}}$(b.id).append('<p class="tip_loading" id="tip_loading">Loading....</p>');function u(C,B){var y=$("#"+B.tId+"_span");if(B.editNameFlag||$("#addBtn_"+B.tId).length>0){return;}var z="<span class='button add' id='addBtn_"+B.tId+"' title='add node' onfocus='this.blur();'></span>";if(b.showAddBtnOnLevel===undefined){y.after(z);}else{if(B.level<=Number(b.showAddBtnOnLevel)){y.after(z);}}var A=$("#addBtn_"+B.tId);if(A){A.bind("click",function(){c.addNodes(B,{id:(99999+d),pId:B.id,name:"new node"});o(B.id,"add");return false;});}}function s(z,y){e=(e==="dark"?"":"dark");c.selectNode(y);return confirm("Are you sure to delete node "+y.name+"?");}function g(z,y){$("#addBtn_"+y.tId).unbind().remove();}function i(B,A,z){var y=c.getSelectedNodes(),C=p(y[0].id);$(".mask_adm_r").hide();if(b.menuHasLink){window.location=C;$.fn.zTree.destroy("tree_roleGroup");fedPris.zTree({id:"#tree_roleGroup",setting:"2",dataUrl:$("#tree_roleGroup").attr("data-source")+y[0].id});}}function h(z){var y=c.getNodeByParam("id",z,null);c.selectNode(y);}function p(B){var A="/:"+B,z="http://"+window.location.href.replace(/http\:\/\//g,"").replace(/\/:.*/,""),y=z+A;return y;}function r(y,A,z){o(z.id,"delete");}function o(C,D){var y=x+$("#postPrefix_add").val(),z=x+$("#postPrefix_del").val(),A,B;if(D==="add"){fedPris.popWinShow({id:".pop_loading",maskOut:true,maskIn:true,outAreaClose:false});A=y+C;$.post(A,function(E){if(E.success){node=c.getNodeByParam("id","100000",null);node.id=E.id;c.updateNode(node[0]);fedPris.closeAllPop(3000);var F=p(node.id);window.location=F;h(node.id);}else{alert("Add new node failed, please try again later.");}});}else{B=z+C;$.post(B,function(E){if(E.success){fedPris.closeAllPop(3000);}else{alert("Delete node failed, please try again later.");}});}}var j;if(b.dataUrl!==undefined){isNaN(v)?j=b.dataUrl:j=$("#tree_roleGroup").attr("data-source")+v;}else{j=$(b.id).attr("data-source");}if($(b.id).length===0){return;}$.getJSON(j,function(z){var B,A,y;$("#tip_loading").remove();$.fn.zTree.destroy(a);$.fn.zTree.init($(b.id),q,z);c=$.fn.zTree.getZTreeObj(a);c.expandAll(true);B=c.getNodesByParam("enable",false,null);y=B.length;for(A=0;A<y;A++){B[A].font="'font-style':'italic'";c.setting.view.fontCss.color="#999";c.updateNode(B[A]);}if(b.defaultNode!==undefined){isNaN(v)?h(b.defaultNode):h(v);}});if($("#tree_roleGroup").length>0){$(document).off().on("click",".sbmt",function(){var E=$.fn.zTree.getZTreeObj("tree_roleGroup"),B=E.getChangeCheckedNodes(),F=[],A={};if(isNaN(v)){A.id=1;}else{A.id=v;}for(var D=0,y=B.length;D<y;D++){var z={};if(B[D].id!==1){z.id=B[D].id;z.checked=B[D].checked;F.push(z);}}A.selectedMenu=F;if(F.length>0){var C=x+$("#post_sbmtMenuRole").val();$.post(C,A,function(G){if(G.success){$("#flat_roleMenu").val("success");}else{alert("Add new node failed, please try again later.");}});}else{$("#flat_roleMenu").val("noChanged");}});}},rowSpan:function(){$("td").each(function(){var a=$(this);if(a.hasClass(".js_combine")){a.hide();}});},ngShowPop:function(a){$(document).on("click",".js_showPopBtn",function(){fedPris.popWinShow({id:a,maskOut:true,maskIn:false});});},ngShowLoading:function(){$(document).on("click",".js_showPopBtn",function(){fedPris.popWinShow({id:"#pop_loading",maskOut:false,maskIn:true});});},common:function(){this.navHover();this.rowSpan();this.inputTips();this.tdEvenOdd();},setMenuRole:function(){this.navHover();this.inputTips();this.zTree({id:"#tree_menuPriv",setting:"1",defaultNode:"3",menuHasLink:true});this.zTree({id:"#tree_roleGroup",setting:"2",dataUrl:$("#tree_roleGroup").attr("data-source")+"1"});this.zTree({id:"#tree_roleMenu",setting:"1",defaultNode:"1",showAddBtnOnLevel:"0",menuHasLink:true});this.modShowHide();}};